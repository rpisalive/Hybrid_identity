This is the repository for the hybrid identity project. Scripts of different analysis are stored here.
Raw data in .mtx , .txt & .tsv format (must be gziped) are suuported.
Pipeline tested with Seurat V4.

Prerequisites:
1. A corresponding file architecture:
   - Each raw dataset must be stored in one directory named by the corresponding accession number. (e.g. sample.mtx.gz in GSE12345 directory) 
   - Directories named by accession codes must be stored in a directory named by its corresponding organ source. (e.g. GSE12345 in liver directory)
   -  Directories named by organ names must be stored in the raw_data_path.
   -  A "saved_RDS" directory stored in the organ directory.
   -  A "metadata" directory stored in the "saved_RDS" directory.
2. The data loading part of the filtering pipeline does not include .RData loading, please load your .RData object and extract the raw count matrix from the corresponding seurat object in your .RData.
3. In case of 10X format, you do not need to rename the three files as barcodes.tsv.gz, features.tsv.gz and matrix.mtx.gz, as long as the name contains "barcodes", "features" and "matrix", the pipeline will handle it automatically. The Read10X is not used in the pipeline.
4. For metadata loading:
   - Metadata should be in either .tsv, .txt or .csv (gizped) format and stored in the "metadata" directory.
   - The name of the metadata must be in XXXX_meta.csv/txt/tsv.gz format, where XXXX has to be the same as the XXXX in the name of XXXX_filtered.rds generated by the filtering_pipeline.
   - Current metadata transfer pipeline only support cell id/name matching, which has to be the first column of the metadata. Please edit the metadata if this is not the case.
   - Individual metadata loading workflows are provided for individual accession codes, please follow the instruction provided in the code.

Notebooks for spatial transcriptomics are for 10X Visium platform, using DestVI as the deconvolution tool. The spatial pipeline is a trial to look for hybrid cell expression in spatially resolved context.
